import pandas as pd

# Load the dataset
df = pd.read_excel('path_to_your_first_dataset.xlsx')  # Replace with your actual file path

# Step 1: Filter rows where 'Netting Opportunity USD' is 0
zero_netting_df = df[df['Netting Opportunity USD'] == 0]

# Step 2: Further filter rows where 'Direction' is 'DEL'
del_rows_df = zero_netting_df[zero_netting_df['Direction'] == 'DEL']

# Step 3: Group by 'Unique' and calculate the sum of 'Amount USD'
grouped_sum_df = del_rows_df.groupby('Unique').agg(
    Sum_Amount_USD=('Amount USD', 'sum')
).reset_index()

# Save the result to a new Excel file
grouped_sum_df.to_excel('Filtered_Sum_Amount_USD.xlsx', index=False)

print("Filtered data with sum of Amount USD saved to 'Filtered_Sum_Amount_USD.xlsx'.")

