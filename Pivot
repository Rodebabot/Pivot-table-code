import pandas as pd

# Assuming df is your dataframe

# Step 1: Group by 'Product Representation' and 'Trade ID', and count the number of unique event IDs per Trade ID
event_ids_per_trade = df.groupby(['Product Representation', 'Trade ID'])['Unique Eventid'].nunique().reset_index()
event_ids_per_trade.columns = ['Product Representation', 'Trade ID', 'Unique Eventid Count']

# Step 2: Calculate the average number of Unique Event IDs per Trade ID for each Product Representation
avg_event_ids_per_trade = event_ids_per_trade.groupby('Product Representation')['Unique Eventid Count'].mean().reset_index()
avg_event_ids_per_trade.columns = ['Product Representation', 'Average Unique Event IDs per Trade ID']

# Step 3: Calculate the volume of Product Representations (i.e., number of unique event IDs in each product representation)
volume_of_product_representations = df.groupby('Product Representation')['Unique Eventid'].nunique().reset_index()
volume_of_product_representations.columns = ['Product Representation', 'Volume (Unique Event IDs)']

# Step 4: Merge the average event IDs per trade with the volume of product representations
final_result = pd.merge(avg_event_ids_per_trade, volume_of_product_representations, on='Product Representation')

# Final result
print(final_result)

